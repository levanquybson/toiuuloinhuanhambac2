<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Bài toán tối ưu lợi nhuận</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(135deg, #fef6ff, #f8faff);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      text-align: center;
      color: #97266d;
      margin: 20px 0 10px;
    }
    .container {
      display: flex;
      flex-direction: row;
      width: 100%;
      max-width: 1200px;
      margin: 10px 20px 40px;
      gap: 20px;
    }
    .left, .right {
      flex: 1;
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    h2 {
      color: #b83280;
      margin-top: 0;
    }
    .problem {
      background: #fff0f6;
      border-left: 6px solid #b83280;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 6px;
    }
    .form-row {
      display: flex;
      gap: 20px;
      margin-top: 10px;
      align-items: center;
    }
    .form-row label {
      flex: 1;
    }
    input {
      padding: 6px;
      width: 80px;
      margin-left: 6px;
    }
    button {
      margin-top: 15px;
      padding: 10px 18px;
      background: #b83280;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
    }
    button:hover {
      background: #97266d;
    }
    .solution {
      line-height: 1.6;
    }

body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      text-align: center;
      padding: 10px;
      font-size: 14px;
      background: #f0f0f0;
      color: #333;
      border-top: 1px solid #ccc;

      /* chống copy / bôi đen */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }



  </style>
</head>
<body>
  <h1>BÀI TOÁN TỐI ƯU LỢI NHUẬN HÀM BẬC HAI</h1>
<b style="color: blue;">
  --Không có toán học, bạn chẳng thể làm được gì. Mọi thứ quanh ta đều là toán học--
</b>

<p style="text-align: right; color: goldenrod; font-weight: bold;">
  Shakuntala Devi (1929–2013)
</p>  <div class="container">
    <div class="left">
      <h2>Bài toán</h2>
      <div class="problem" id="problem-text">
        (Đề bài sẽ cập nhật theo các giá trị nhập)
      </div>

      <form id="params">
        <div class="form-row">
          <label>Giá gốc a =
            <input type="number" id="a" value="100" oninput="updateProblem()">
          </label>
          <label>Sản lượng ban đầu q =
            <input type="number" id="q" value="50" oninput="updateProblem()">
          </label>
        </div>

        <div class="form-row">
          <label>Mỗi lần giảm giá K =
            <input type="number" id="K" value="2" oninput="updateProblem()">
          </label>
          <label>Số sp tăng thêm r =
            <input type="number" id="r" value="5" oninput="updateProblem()">
          </label>
          </div>
 	<div class="form-row">

	<label>Chi phí c =
            <input type="number" id="c" value="40" oninput="updateProblem()">
          </label>
	</div>
        <button type="button" onclick="solve()">Giải</button>
      </form>
    </div>

    <div class="right">
      <h2>Lời giải</h2>
      <div class="solution" id="solution">
        (Kết quả sẽ hiện ở đây sau khi bấm "Giải")
      </div>
    </div>
  </div>

  <script>
    function updateProblem() {
      const a = document.getElementById("a").value;
      const q = document.getElementById("q").value;
      const c = document.getElementById("c").value;
      const K = document.getElementById("K").value;
      const r = document.getElementById("r").value;

      const problemText = `
        Một công ty bán sản phẩm với:<br>
        - Giá gốc <b>${a}</b> nghìn đồng/sp, sản lượng ban đầu <b>q = ${q}</b> sản phẩm;<br>
        - Nếu mỗi lần giảm giá <b>K = ${K}</b> nghìn đồng thì lượng hàng bán tăng thêm <b>r = ${r}</b> sản phẩm;<br>
        - Chi phí sản xuất mỗi sản phẩm <b>c = ${c}</b> nghìn đồng.<br><br>
        Hỏi: Công ty nên giảm giá bao nhiêu lần để lợi nhuận thu được lớn nhất? 
        Lợi nhuận tối đa là bao nhiêu?
      `;
      document.getElementById("problem-text").innerHTML = problemText;
    }

    function solve() {
      const a = parseFloat(document.getElementById("a").value);
      const q = parseFloat(document.getElementById("q").value);
      const c = parseFloat(document.getElementById("c").value);
      const K = parseFloat(document.getElementById("K").value);
      const r = parseFloat(document.getElementById("r").value);

      updateProblem();

      const A = -K * r;
      const B = a * r - c * r - K * q;
      const C = (a - c) * q;

      const xVertex = -B / (2 * A);
      let xOpt = Math.round(xVertex);

      // Ràng buộc: 0 <= x <= a/K
      const xMax = Math.floor(a / K);
      if (xOpt < 0) xOpt = 0;
      if (xOpt > xMax) xOpt = xMax;

      const LOpt = A * xOpt * xOpt + B * xOpt + C;
      const priceOpt = a - K * xOpt;
      const qOpt = q + r * xOpt;

      const solutionText = `
        Gọi \\(x\\) là số lần giảm giá (nguyên, \\(0 \\leq x \\leq ${xMax}\\)).<br><br>
        - Giá bán mới: \\(p(x) = a - Kx = ${a} - ${K}x\\).<br>
        - Sản lượng: \\(q(x) = q + rx = ${q} + ${r}x\\).<br>
        - Lợi nhuận: \\(L(x) = (p(x) - c)q(x) = (${a} - ${K}x - ${c})(${q} + ${r}x)\\).<br><br>

        Rút gọn: \\(L(x) = ${A}x^2 + ${B}x + ${C}\\).<br><br>

        L(x) Hàm bậc hai với hệ số \\(A = ${A} < 0\\) nên L(x) có giá trị lớn nhất đạt tại hoành độ đỉnh của parabol.<br>
        Hoành độ đỉnh: \\(x^* = -\\tfrac{B}{2A} = ${xVertex.toFixed(2)}\\).<br><br>

        Vậy số lần giảm giá tối ưu: \\(x \\approx ${xOpt}\\).<br>
        - Giá bán: ${priceOpt} nghìn đồng/sp.<br>
        - Sản lượng: ${qOpt} sản phẩm.<br>
        - Lợi nhuận tối đa: ${LOpt} nghìn đồng.
      `;

      document.getElementById("solution").innerHTML = solutionText;
      MathJax.typeset(); // render lại công thức
    }

    window.onload = updateProblem;
  </script>
</body>
<meta charset="UTF-8">
<footer id="copyright"></footer>

<script>
  // Base64 đúng (chữ Quý)
  const b64Copyright = "TMOqIFbEg24gUXXDvSwgVEhQVCBCw6xuaCBTxqFuLCBRdeG6o25nIE5nw6Np";

  const bytes = Uint8Array.from(atob(b64Copyright), c => c.charCodeAt(0));
  const text  = new TextDecoder("utf-8").decode(bytes);

  // Kiểm tra nhanh trên console: phải in đúng "© 2025 Lê Văn Quý+GPT. All rights reserved."
  console.log(text);

  document.getElementById("copyright").textContent = text;

  // (tuỳ chọn) chặn chuột phải & Ctrl+C như bạn đã làm
  document.addEventListener("contextmenu", e => e.preventDefault());
  document.addEventListener("keydown", e => {
    if (e.ctrlKey && e.key.toLowerCase() === "c") {
      e.preventDefault();
      alert("!");
    }
  });
</script>

</html>

